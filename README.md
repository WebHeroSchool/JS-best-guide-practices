# JS rules. Best guide practices
>**В данном руководстве представлена лишь малая часть парвил, которых необходимо придерживаться, если Вы хотите, чтобы Ваш код был читабельым, правильным и соответствовал современным стандартам. Надеюсь эти правила, используемые повседневно в коде будут Вам полезными.** :wink:
___

## 1. Не используйте var!
> Объявляйте все переменные с помощью *const* или *let*. Используйте const по умолчанию, если переменная не требует переназначения. Ключевое слово *var* не должно использоваться.

```js
    // Плохо
       var example = 42;
    // Хорошо
       let example = 42;
```
> *Минимизируйте использование глобальных переменных.*

>>*__Важно__ Глобальные переменные и функции могут быть перезаписаны другими скриптами.*


## 2. Объявление на "вершине"
Это хорошая практика кодирования, поместить все объявления в верхней части каждого сценария или функции.
Будет хорошим тоном:
+ Предоставить более чистый код;
+ Обозначить единственное место для поиска локальных переменных;
+ Сделать его проще, чтобы избежать нежелательных (подразумеваемых) глобальных переменных;
+ Уменьшить вероятность нежелательных повторных объявлений;
+ Писать комментарии к коду, который может быть неправильно воспринят.
___

```js
    // Объявить в самом начале
       let firstName, lastName, price, discount, fullPrice;

    // Далее присвоить значения объявленным переменным
       firstName = "Андрей";
       lastName = "Щипунов";

       price = 19.90;
       discount = 0.10;

       fullPrice = price * 100 / discount;
```

Это также относится к переменным цикла:
```js
      // Объявить в самом начале
         const i;

      // Использовать позже
         for (i = 0; i < 5; i++) {
```

> *По умолчанию JavaScript перемещает все объявления наверх [(JavaScript Всплытие)](https://schoolsw3.com/js/js_hoisting.php)*


 ## 3. Функции.
+ **При объявлении функций отдавайте предпочтение стрелочным функциям**

```js
      // плохо
         [1, 2, 3].map(function (x) {
         const y = x + 1;
         return x * y;
      });

      // хорошо
         [1, 2, 3].map((x) => {
         const y = x + 1;
         return x * y;
      });
```
 > __Примечание__ Стрелочные функции делают синтаксис лаконичным и устраняют некоторые трудности с ним. Отдавайте предпочтение стрелочным функциям, вместо ключевого слова function, особенно для вложенных функций.
 
 + Никогда не объявляйте функцию внутри блока кода — например в if, while, else и так далее. Единственное исключение — блок функции. Вместо этого присваивайте функцию уже объявленной через *const* или *let* переменной. Условное объявление функций работает, но в различных браузерах работает по-разному.
 > __Примечание__ ECMA-262 устанавливает понятие блока как списка операторов. Объявление функции (не путайте с присвоением функции переменной) не является оператором. [Комментарий по этому вопросу в ECMA-262](https://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf#page=97).
 
 ```js
        // плохо
           if (currentUser) {
           function test() {
            console.log('Плохой мальчик.');
           }
        }

        // хорошо
           const test;
           if (currentUser) {
           test = function test() {
              console.log('Молодец.');
            };
        }
```
+ __!Никогда__ не используйте аргумент функции *arguments*, он будет более приоритетным над объектом *arguments*, который доступен без объявления для каждой функции.

 ```js
           // плохо
            function nope(name, options, arguments) {
           // ...код...
            }

           // хорошо
            function yup(name, options, args) {
           // ...код...
            }
```

## 4. Объявление инструкций.
+*Каждая инструкция должна заканчиваться точкой с запятой. Использование автоматической вставки точки с запятой запрещено.*
 
 ```js
      // bad
         let luke = {}
         let leia = {}
         [luke, leia].forEach(jedi => jedi.father = 'vader')
      // good
         let luke = {};
         let leia = {};
         [luke, leia].forEach((jedi) => {
         jedi.father = 'vader';
      });
```
___
__Почему это важно?__ Потому что при присваивании без точки с запятой в конце можно прихватить что нибудь лишнее, например выражение в скобках может быть понято как вызов функции:==
```js
    const i = 0
    (2+1).toString();
```
Или вы хотите сделать массив, а интерпретатор может подумать, что вы хотите достать из конца предыдущей строки какое-то свойство:==

```js
      console.log(2)
      [1,2].map(num => num*2);
```
___

## 5. Объекты и Массивы.
+ Для создания объекта используйте фигурные скобки. Не создавайте объекты через конструктор *new Object*.

```js
      // плохо
         let item = new Object();

      // хорошо
         let item = {};
```

+ Не используйте [зарезервированные слова](https://es5.github.io/#x7.6.1) в качестве ключей объектов. Они не будут работать в IE8. [Подробнее](https://github.com/airbnb/javascript/issues/61)

```js
      // плохо
         const superman = {
         default: { clark: 'kent' },
         private: true
      };
      // хорошо
         const superman = {
         defaults: { clark: 'kent' },
         hidden: true
      };
```
+ Не используйте ключевые слова (в том числе измененные). Вместо них используйте синонимы.

```js
        // плохо
           const superman = {
           class: 'alien'
      };

        // плохо
           const superman = {
           klass: 'alien'
      };

        // хорошо
           const superman = {
           type: 'alien'
       };
```
___

+ Для создания массива используйте квадратные скобки. Не создавайте массивы через конструктор *new Array*.
   
```js   
        // плохо
           const items = new Array();

        // хорошо
           const items = [];
 ```          

 ## 6. Использование шаблонных строк вместо конкатенации.
 
+*Используйте шаблонные строки (разделённые символом `) вместо конкатенации комплексных строк, особенно если используется несколько строковых литералов. Шаблонные строки могут занимать несколько строк.*

```js
      // bad
         function sayHi(name) {
         return 'How are you, ' + name + '?';
      }

      // bad
         function sayHi(name) {
         return ['How are you, ', name, '?'].join();
      }

      // bad
         function sayHi(name) {
         return `How are you, ${ name }?`;
      }

      // good
         function sayHi(name) {
         return `How are you, ${name}?`;
      }
```
>*Использование шаблонных строк делает код более красивым и не таким грамоздским*

 ## 7. Условные выражения и равенства.
+ Используйте === и !== вместо == и !=.
+ Условные выражения вычисляются посредством приведения к логическому типу *Boolean* через метод *ToBoolean* и всегда следуют следующим правилам:
    -__Object__ всегда соответствует __true__
    -__Undefined__ всегда соответствует __false__
    -__Null__ всегда соответствует __false__
    -__Boolean__ остается неизменным
    -__Number__ соответствует __false__, если является __+0, -0, или NaN,__ в противном случае соответствует __true__
    -__String__ означает __false__, если является пустой строкой __''__, в противном случае __true__. Условно говоря, для строки происходит сравнение не ее самой, а ее длины – в соответствии с типом *number*.
    
    ```js
          if ([0]) {
        // true
        // Массив(Array) является объектом, объекты преобразуются в true
}
    ```
+ Используйте короткий синтаксис.
    
    ```js
            // плохо
                if (name !== '') {
            // ...код...
        }

            // хорошо
                if (name) {
            // ...код...
        }

            // плохо
                if (collection.length > 0) {
            // ...код...
        }

            // хорошо
                if (collection.length) {
            // ...код...
        }
    ```
+ Более подробно можно прочитать в статье [Truth Equality and JavaScript](https://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/) от Angus Croll   
 
 ## 8. Блоки кода. Строки.
 + Используйте фигурные скобки для всех многострочных блоков.
 ```js
        // плохо
            if (test)
             return false;

        // хорошо
            if (test) return false;

        // хорошо
            if (test) {
              return false;
            }

        // плохо
            function() { return false; }

        // хорошо
            function() {
                return false;
            }
 ```
 ___
 
 +Использование одинарных кавычкек '' для строк более предпочтительнее.
 ```js
      // плохо
         let name = "Боб Дилан";

      // хорошо
         let name = 'Боб Дилан';

      // плохо
         let fullName = "Боб " + this.lastName;

      // хорошо
         let fullName = 'Дилан ' + this.lastName;

```
+Строки длиннее 80 символов нужно разделять, выполняя перенос через конкатенацию строк.
>**Осторожно:** строки с большим количеством конкатенаций могут отрицательно влиять на быстродействие. [Обсуждение](https://github.com/airbnb/javascript/issues/40)

```js
      // плохо
         let errorMessage = 'Эта сверхдлинная ошибка возникла из-за белой обезъяны. Не говори про обезъяну! Не слушай об обезьяне! Не            думай об обезъяне!';

      // плохо
         let errorMessage = 'Эта сверхдлинная ошибка возникла из-за белой обезъяны. \
         Не говори про обезъяну! Не слушай об обезьяне! \
         Не думай об обезъяне!';

      // хорошо
         let errorMessage = 'Эта сверхдлинная ошибка возникла из-за белой обезъяны. ' +
        'Не говори про обезъяну! Не слушай об обезьяне! ' +
        'Не думай об обезъяне!';
```
+Когда строка создается программным путем, используйте Array::join вместо объединения строк. В основном для IE: [jsPerf](https://jsperf.com/string-vs-array-concat/2).

```js
      var items,
      messages,
      length,
      i;

      messages = [{
      state: 'success',
      message: 'Это работает.'
  },{
      state: 'success',
      message: 'Это тоже.'
  },{
      state: 'error',
      message: 'А я томат.'
  }];

    length = messages.length;

    // плохо
       function inbox(messages) {
       items = '<ul>';

       for (i = 0; i < length; i++) {
        items += '<li>' + messages[i].message + '</li>';
    }

      return items + '</ul>';
  }

    // хорошо
       function inbox(messages) {
       items = [];

       for (i = 0; i < length; i++) {
       items[i] = messages[i].message;
    }

        return '<ul><li>' + items.join('</li><li>') + '</li></ul>';
  }
```


  ## 9. Комментарии.
  >**Воспитывайте в себе эту особенность - писать комментарии там, где это необходимо. Код, написанный читабельно и с комментариями, может существено сэкономить время,чтобы разобраться другим товарищам к которым он может попасть для работы или внесения изменений.
  
  + Используйте */** ... */* для многострочных комментариев. Включите описание, опишите типы и значения для всех параметров и возвращаемых значений в формате *jsdoc*.
  
  ```js
       // плохо
        // make() возвращает новый элемент
        // основываясь на получаемом имени тэга
        //
        // @param <String> tag
        // @return <Element> element
            function make(tag) {

        // ...создаем element...

            return element;
        }

       // хорошо
        /**
        * make() возвращает новый элемент
        * основываясь на получаемом имени тэга
        *
        * @param <String> tag
        * @return <Element> element
        */
            function make(tag) {

        // ...создаем element...

            return element;
        }
  ```
  + Используйте // для комментариев в одну строку. Размещайте комментарии на новой строке над темой комментария. Добавляйте пустую строку над комментарием.
  
  ```js
        // плохо
            const active = true;  // устанавливаем активным элементом

        // хорошо
        // устанавливаем активным элементом
            const active = true;

        // плохо
            function getType() {
                console.log('проверяем тип...');
        // задаем тип по умолчанию 'no type'
            const type = this._type || 'no type';

        return type;
    }

        // хорошо
            function getType() {
             console.log('проверяем тип...');

        // задаем тип по умолчанию 'no type'
             const type = this._type || 'no type';

        return type;
    }
  ```

   ## 10. Пробелы.
   + Используйте программную табуляцию (ее поддерживают все современные редакторы кода и IDE) из двух пробелов.
   
   ```js
        // плохо
            function() {
            ∙∙∙∙const name;
        }

        // плохо
            function() {
            ∙const name;
        }

        // хорошо
            function() {
            ∙∙const name;
        }
   ```
   + Устанавливайте один пробел перед открывающей скобкой.
   
   ```js
        // плохо
            function test(){
                console.log('test');
        }

        // хорошо
            function test() {
                console.log('test');
        }

        // плохо
            dog.set('attr',{
            age: '1 year',
            breed: 'Bernese Mountain Dog'
        });

        // хорошо
            dog.set('attr', {
            age: '1 year',
            breed: 'Bernese Mountain Dog'
        });
   ```
   + Используйте отступы, когда делаете цепочки вызовов.
   
   ```js
        // плохо
            $('#items').find('.selected').highlight().end().find('.open').updateCount();

        // хорошо
            $('#items')
              .find('.selected')
                .highlight()
                .end()
              .find('.open')
                .updateCount();

        // плохо
            const leds = stage.selectAll('.led').data(data).enter().append('svg:svg').class('led', true)
            .attr('width',  (radius + margin) * 2).append('svg:g')
            .attr('transform', 'translate(' + (radius + margin) + ',' + (radius + margin) + ')')
            .call(tron.led);

        // хорошо
            const leds = stage.selectAll('.led')
            .data(data)
                .enter().append('svg:svg')
                .class('led', true)
                .attr('width',  (radius + margin) * 2)
            .append('svg:g')
                .attr('transform', 'translate(' + (radius + margin) + ',' + (radius + margin) + ')')
                .call(tron.led);
   ```
